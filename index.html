<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Sistema Premium S77</title>

<style>
body{
  font-family: "Poppins", Arial, sans-serif;
  background:#0c0f14;
  color:#f4f4f4;
  text-align:center;
  padding:20px;
}

h1,h2,h3{
  letter-spacing:.5px;
}

.panel{
  max-width:520px;
  margin:15px auto;
  padding:18px;
  border-radius:18px;
  background:linear-gradient(180deg, #0f131a, #0b0e13);
  box-shadow:0 20px 40px rgba(0,0,0,.45),
             inset 0 0 0 1px rgba(255,215,0,.08);
  border:1px solid rgba(255,215,0,.12);
}

.hidden{display:none}

input,select,button{
  padding:10px;
  border-radius:10px;
  border:1px solid rgba(255,215,0,.25);
  margin:6px;
  background:#0f131a;
  color:#ffd782;
}

input:focus,select:focus{
  outline:none;
  box-shadow:0 0 0 2px rgba(255,215,0,.35);
}

button{
  background:linear-gradient(135deg,#c9a646,#ffd782);
  color:#141414;
  font-weight:bold;
  cursor:pointer;
  transition:.25s;
}
button:hover{
  transform:translateY(-1px);
  box-shadow:0 10px 20px rgba(255,215,0,.25);
}

.inputs{
  display:grid;
  grid-template-columns:repeat(4,70px);
  gap:12px;
  justify-content:center;
}

.inputs input{
  width:70px;height:70px;
  font-size:32px;
  font-weight:bold;
  text-align:center;
  border:2px solid rgba(255,215,0,.45);
  background:#0f131a;
  color:#ffd782;
  border-radius:14px;
}

.inputs input:first-child{
  background:#1b2230;
}

.nuevo{
  width:80px;height:80px;
  font-size:36px;
  font-weight:bold;
  text-align:center;
  border:2px solid rgba(255,215,0,.65);
  background:#1b2230;
  color:#ffd782;
  border-radius:16px;
}

.favoritos,
.explosivos{
  padding:16px;
  border-radius:14px;
  min-height:45px;
  display:inline-block;
  margin-top:5px;
  letter-spacing:.5px;
  transition:.35s;
}

.favoritos{
  background:rgba(255,215,0,.12);
  color:#ffd782;
  border:1px solid rgba(255,215,0,.3);
}

.explosivos{
  background:rgba(255,120,75,.12);
  color:#ffb29d;
  border:1px solid rgba(255,120,75,.35);
}

/* âœ¨ AnimaciÃ³n suave */
.pulse{
  animation:pulse .9s ease-out;
}

@keyframes pulse{
  0%{ box-shadow:0 0 0 0 rgba(255,215,0,.55); }
  100%{ box-shadow:0 0 0 25px rgba(255,215,0,0); }
}
</style>
</head>

<body>

<h1>ðŸŽ¡ Sistema Premium S77</h1>

<!-- LOGIN -->
<div class="panel" id="login">
  <h2>INGRESAR CLAVE</h2>
  <input id="clave">
  <br>
  <button onclick="login()">INGRESAR</button>
  <p id="error" style="color:red;"></p>
</div>

<!-- ADMIN -->
<div class="panel hidden" id="admin">
  <h2>ADMINISTRADOR</h2>
  <input id="nuevaClave" placeholder="Clave usuario">
  <select id="dias">
    <option value="1">1 dÃ­a</option>
    <option value="7">7 dÃ­as</option>
    <option value="30">30 dÃ­as</option>
  </select>
  <br>
  <button onclick="crearUsuario()">CREAR USUARIO</button>
</div>

<!-- S77 -->
<div class="panel hidden" id="s77">
  <h2>ÃšLTIMOS 16 NÃšMEROS</h2>

  <div class="inputs">
    <input disabled><input disabled><input disabled><input disabled>
    <input disabled><input disabled><input disabled><input disabled>
    <input disabled><input disabled><input disabled><input disabled>
    <input disabled><input disabled><input disabled><input disabled>
  </div>

  <h3>NUEVO NÃšMERO</h3>
  <input class="nuevo" id="nuevoNumero" type="number">
  <br>
  <button onclick="reiniciar()">REINICIAR</button>

  <h3>FAVORITOS</h3>
  <div class="favoritos" id="fav">â€”</div>

  <h3>EXPLOSIVOS</h3>
  <div class="explosivos" id="exp">â€”</div>
</div>

<script>
const API = "https://s77-backend.onrender.com";
const API_KEY = "S77-PRIVATE-2025";

let ultimos=[];
let adminClave=null;

const cas=[...document.querySelectorAll(".inputs input")];

async function login(){
  const clave=document.getElementById("clave").value;
  const r=await fetch(API+"/login",{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "x-api-key": API_KEY
    },
    body:JSON.stringify({clave})
  });
  const d=await r.json();
  if(!d.ok){
    document.getElementById("error").innerText=d.error;
    return;
  }
  document.getElementById("login").classList.add("hidden");
  document.getElementById("s77").classList.remove("hidden");
  if(d.admin){
    adminClave=clave;
    document.getElementById("admin").classList.remove("hidden");
  }
}

async function crearUsuario(){
  const nuevaClave=document.getElementById("nuevaClave").value;
  const dias=document.getElementById("dias").value;
  await fetch(API+"/crear-usuario",{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "x-api-key": API_KEY
    },
    body:JSON.stringify({adminClave,nuevaClave,dias})
  });
  alert("Usuario creado");
}

document.getElementById("nuevoNumero").onchange=async e=>{
  const v=parseInt(e.target.value);
  if(isNaN(v))return;

  ultimos.unshift(v);
  if(ultimos.length>16)ultimos.pop();

  render();

  const r=await fetch(API+"/calcular",{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "x-api-key": API_KEY
    },
    body:JSON.stringify({ultimos})
  });

  const d=await r.json();

  const favBox = document.getElementById("fav");
  const expBox = document.getElementById("exp");

  favBox.innerText = d.favoritos.length ? d.favoritos.join(", ") : "â€”";
  expBox.innerText = d.explosivos.length ? d.explosivos.join(", ") : "â€”";

  favBox.classList.remove("pulse");
  expBox.classList.remove("pulse");

  setTimeout(()=>{
    favBox.classList.add("pulse");
    expBox.classList.add("pulse");
  },10);

  e.target.value="";
};

function render(){
  cas.forEach((c,i)=>c.value=ultimos[i]??"");
}

function reiniciar(){
  ultimos=[];
  render();
  fav.innerText="â€”";
  exp.innerText="â€”";
}
</script>

</body>
  </html>
  
